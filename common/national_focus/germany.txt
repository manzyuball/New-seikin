search_filter_prios = {
	FOCUS_FILTER_POLITICAL = 1010
	FOCUS_FILTER_INDUSTRY = 509
	FOCUS_FILTER_ARMY_XP = 103
	FOCUS_FILTER_NAVY_XP = 102
	FOCUS_FILTER_AIR_XP = 101
}

focus_tree = {
	id = german_focus

	country = {
		factor = 0
		modifier = {
			add = 10
			tag = GER
		}
	}

	default = no

	initial_show_position = {
		focus = GER_war_plans
	}

	########################################
	# 戦車クラスター
	# 起点: 国防軍の戦車計画 (全体基準)
	########################################

	focus = {
		id = GER_war_plans
		icon = GFX_goal_rhineland
		x = 5
		y = 0
		cost = 0
		search_filters = { FOCUS_FILTER_ARMY_XP }
		completion_reward = {
			custom_effect_tooltip = GER_war_plans_tt
		}
	}

	# 左列: Pz III → 派生 → レオパルト構想

	focus = {
		id = GER_tank_III_tank_mass_production
		icon = GFX_focus_generic_tankette
		cost = 0

		relative_position_id = GER_war_plans
		x = -5
		y = 1
		search_filters = { FOCUS_FILTER_ARMY_XP }
		prerequisite = { focus = GER_war_plans }
        mutually_exclusive = { focus = GER_tank_IV_tank_production }
		mutually_exclusive = { focus = GER_tank_tiger_dev }
		mutually_exclusive = { focus = GER_spec_gebirgsjaeger_plan }
		mutually_exclusive = { focus = GER_air_Luftwaffe_plan }
		completion_reward = {
			custom_effect_tooltip = GER_tank_III_tank_mass_production_tt
			set_technology = {
				basic_medium_td = 1
				basic_medium_art = 1
				basic_medium_spaa = 1
			}
			hidden_effect = {
				division_template = {
					name = "III型突撃砲師団"
					is_locked = no
					priority = 1
					regiments = {
						medium_tank_destroyer_brigade = { x = 0 y = 0 }
						medium_tank_destroyer_brigade = { x = 0 y = 1 }
						medium_armor = { x = 1 y = 0 }
						motorized = { x = 2 y = 0 }
						motorized = { x = 2 y = 1 }
					}
					support = {
						engineer = { x = 0 y = 0 }
						logistics_company = { x = 0 y = 1 }
                        signal_company = {
							x = 0
							y = 2
						}
						mot_recon = {
							x = 0
							y = 3
						}
					}
				}
				division_template = {
					name = "III号コオロギ師団"
					is_locked = no
					priority = 1
					regiments = {
						medium_sp_artillery_brigade = { x = 0 y = 0 }
						medium_sp_artillery_brigade = { x = 0 y = 1 }
						medium_armor = { x = 1 y = 0 }
						motorized = { x = 2 y = 0 }
						motorized = { x = 2 y = 1 }
					}
					support = {
						engineer = { x = 0 y = 0 }
						logistics_company = { x = 0 y = 1 }
                        signal_company = {
							x = 0
							y = 2
						}
						mot_recon = {
							x = 0
							y = 3
						}
					}
				}
				capital_scope = {
					create_unit = {
						division = "name = \"III型突撃砲師団\" division_template = \"III型突撃砲師団\" start_experience_factor = 0.3"
						owner = GER
						count = 10
						allow_spawning_on_enemy_provs = no
					}
					create_unit = {
						division = "name = \"III号コオロギ師団\" division_template = \"III号コオロギ師団\" start_experience_factor = 0.3"
						owner = GER
						count = 10
						allow_spawning_on_enemy_provs = no
					}
				}
			}
		}
	}
	focus = {
		id = GER_tank_leopard_dev
		icon = GFX_focus_generic_tank_assault
		cost = 5

		relative_position_id = GER_tank_III_tank_mass_production
		x = 0
		y = 1
		search_filters = { FOCUS_FILTER_ARMY_XP }
		prerequisite = { focus = GER_tank_III_tank_mass_production }

		completion_reward = {
			custom_effect_tooltip = GER_tank_leopard_dev_tt
			
			set_technology = {
				advanced_light_tank = 1
			}
			hidden_effect = {
				division_template = {
					name = "レオパルト試験機甲師団"
					is_locked = no
					priority = 1
					regiments = {
						light_armor = { x = 0 y = 0 }
						light_armor = { x = 0 y = 1 }
						light_armor = { x = 1 y = 0 }
						motorized = { x = 2 y = 0 }
						motorized = { x = 2 y = 1 }
						motorized = { x = 3 y = 0 }
					}
					support = {
						engineer = { x = 0 y = 0 }
						logistics_company = { x = 0 y = 1 }
                        signal_company = {
							x = 0
							y = 2
						}
						mot_recon = {
							x = 0
							y = 3
						}
					}
				}
				capital_scope = {
					create_unit = {
						division = "name = \"レオパルト試験機甲師団\" division_template = \"レオパルト試験機甲師団\" start_experience_factor = 0.3"
						owner = GER
						count = 20
						allow_spawning_on_enemy_provs = no
					}
				}
			}
		}
	}

	# 中央列: Pz IV → 長砲身 → パンター → パンター改良

	focus = {
		id = GER_tank_IV_tank_production
		icon = GFX_focus_generic_mass_production
		cost = 0

		relative_position_id = GER_war_plans
		x = -3
		y = 1
		search_filters = { FOCUS_FILTER_ARMY_XP }
		prerequisite = { focus = GER_war_plans }
        mutually_exclusive = { focus = GER_tank_III_tank_mass_production }
		mutually_exclusive = { focus = GER_tank_tiger_dev }
		mutually_exclusive = { focus = GER_spec_gebirgsjaeger_plan }
		mutually_exclusive = { focus = GER_air_Luftwaffe_plan }
		completion_reward = {
			custom_effect_tooltip = GER_tank_IV_tank_production_tt
		}
	}

	focus = {
		id = GER_tank_panther
		icon = GFX_focus_generic_tank_assembly
		cost = 5

		relative_position_id = GER_tank_IV_tank_production
		x = 0
		y = 1
		search_filters = { FOCUS_FILTER_ARMY_XP }
		prerequisite = { focus = GER_tank_IV_tank_production }

		completion_reward = {
			custom_effect_tooltip = GER_tank_panther_tt
			hidden_effect = {
				# パンター中戦車師団 用テンプレート解禁＋スポーン
				division_template = {
					name = "パンター中戦車師団"
					is_locked = no
					priority = 1
					regiments = {
						medium_armor = { x = 0 y = 0 }
						medium_armor = { x = 1 y = 0 }
						motorized = { x = 2 y = 0 }
						medium_armor = { x = 0 y = 1 }
						motorized = { x = 1 y = 1 }
						motorized = { x = 2 y = 1 }
					}
					support = {
						engineer = { x = 0 y = 0 }
						recon = { x = 0 y = 1 }
						maintenance_company = { x = 0 y = 2 }
					}
				}
				capital_scope = {
					create_unit = {
						division = "name = \"パンター中戦車師団\" division_template = \"パンター中戦車師団\" start_experience_factor = 0.6"
						owner = GER
						count = 2
						allow_spawning_on_enemy_provs = no
					}
				}
			}
		}
	}

	# 右列: ティーガー → ケーニヒスティーガー / 派生 → マウス

	focus = {
		id = GER_tank_tiger_dev
		icon = GFX_focus_generic_heavy_tank
		cost = 0

		relative_position_id = GER_war_plans
		x = -1
		y = 1
		search_filters = { FOCUS_FILTER_ARMY_XP }
		prerequisite = { focus = GER_war_plans }
        mutually_exclusive = { focus = GER_tank_III_tank_mass_production }
		mutually_exclusive = { focus = GER_spec_gebirgsjaeger_plan }
		mutually_exclusive = { focus = GER_air_Luftwaffe_plan }
		mutually_exclusive = { focus = GER_tank_IV_tank_production }
		completion_reward = {
			custom_effect_tooltip = GER_tank_tiger_dev_tt
			hidden_effect = {
				# ティーガー重戦車技術はバニラ tech: heavy_tank2 (例) を前提とし、
				# NFでは追加バフを与えず「ルート選択の物語付け」とする。
			}
		}
	}

	focus = {
		id = GER_tank_ktiger
		icon = GFX_focus_BRA_acquire_german_tanks
		cost = 5

		relative_position_id = GER_tank_tiger_dev
		x = 0
		y = 1
		search_filters = { FOCUS_FILTER_ARMY_XP }
		prerequisite = { focus = GER_tank_tiger_dev }

		completion_reward = {
			custom_effect_tooltip = GER_tank_ktiger_tt
			hidden_effect = {
				# ケーニヒスティーガー技術もバニラ heavy_tank3 等に紐付け、追加の技術付与は行わない。
			}
		}
	}


	focus = {
		id = GER_tank_maus_dev
		icon = GFX_goal_generic_secret_weapon
		cost = 5

		relative_position_id = GER_tank_ktiger
		x = 0
		y = 1
		search_filters = { FOCUS_FILTER_ARMY_XP }
		prerequisite = { focus = GER_tank_ktiger }

		completion_reward = {
			custom_effect_tooltip = GER_tank_maus_dev_tt
			hidden_effect = {
				# マウス超重戦車師団 用テンプレート解禁＋スポーン
				division_template = {
					name = "マウス超重戦車師団"
					is_locked = no
					priority = 1
					regiments = {
						super_heavy_armor = { x = 0 y = 0 }
						super_heavy_armor = { x = 1 y = 0 }
						super_heavy_armor = { x = 0 y = 1 }
						super_heavy_armor = { x = 1 y = 1 }
					}
					support = {
						engineer = { x = 0 y = 0 }
						logistics_company = { x = 0 y = 1 }
					}
				}
				capital_scope = {
					create_unit = {
						division = "name = \"マウス超重戦車師団\" division_template = \"マウス超重戦車師団\" start_experience_factor = 0.7"
						owner = GER
						count = 1
						allow_spawning_on_enemy_provs = no
					}
				}
			}
		}
	}

	########################################
	# 機械化歩兵クラスター(装甲兵員輸送車)
	########################################

	# 機械化歩兵師団
	focus = {
		id = GER_mech_mechanized_infantry
		icon = GFX_focus_generic_mechanized
		cost = 5

		relative_position_id = GER_spec_gebirgsjaeger_plan
		x = 0
		y = 1
		search_filters = { FOCUS_FILTER_ARMY_XP }
		prerequisite = { focus = GER_spec_gebirgsjaeger_plan }

		completion_reward = {
			custom_effect_tooltip = GER_mech_mechanized_infantry_tt
			hidden_effect = {
				# 装甲擲弾兵師団 用テンプレート解禁＋スポーン
				division_template = {
					name = "装甲擲弾兵師団"
					is_locked = no
					priority = 1
					regiments = {
						motorized = { x = 0 y = 0 }
						motorized = { x = 1 y = 0 }
						motorized = { x = 2 y = 0 }
						motorized = { x = 0 y = 1 }
						motorized = { x = 1 y = 1 }
						motorized = { x = 2 y = 1 }
						motorized = { x = 0 y = 2 }
						motorized = { x = 1 y = 2 }
					}
					support = {
						engineer = { x = 0 y = 0 }
						recon = { x = 0 y = 1 }
					}
				}
				capital_scope = {
					create_unit = {
						division = "name = \"装甲擲弾兵師団\" division_template = \"装甲擲弾兵師団\" start_experience_factor = 0.6"
						owner = GER
						count = 2
						allow_spawning_on_enemy_provs = no
					}
				}
			}
		}
	}

	########################################
	# 山岳猟兵クラスター(簡易)
	########################################

	# 山岳猟兵構想
	focus = {
		id = GER_spec_gebirgsjaeger_plan
		icon = GFX_focus_GER_gebirgsjager
		cost = 0
        available = {
			capital_scope = {
				is_owned_and_controlled_by = ROOT
			}
		}
		prerequisite = { focus = GER_war_plans }
		relative_position_id = GER_war_plans
		x = 1
		y = 1
		mutually_exclusive = { focus = GER_tank_III_tank_mass_production }
		mutually_exclusive = { focus = GER_tank_tiger_dev }
		mutually_exclusive = { focus = GER_air_Luftwaffe_plan }
		mutually_exclusive = { focus = GER_tank_IV_tank_production }
		search_filters = { FOCUS_FILTER_ARMY_XP }
		completion_reward = {
			custom_effect_tooltip = GER_spec_gebirgsjaeger_plan_tt
			hidden_effect = {
				division_template = {
					name = "山岳猟兵編制"
					is_locked = no
					priority = 1
					regiments = {
						mountaineers = { x = 0 y = 0 }
						mountaineers = { x = 1 y = 0 }
						artillery_brigade = { x = 2 y = 0 }
						mountaineers = { x = 0 y = 1 }
						mountaineers = { x = 1 y = 1 }
						artillery_brigade = { x = 2 y = 1 }
					}
					support = {
						anti_air = { x = 0 y = 0 }
						logistics_company = { x = 0 y = 1 }
						engineer = { x = 0 y = 2 }
					}
				}
				capital_scope = {
					create_unit = {
						division = "name = \"山岳猟兵\" division_template = \"山岳猟兵編制\" start_experience_factor = 0.5"
						owner = GER
						count = 3
						allow_spawning_on_enemy_provs = no
					}
				}
			}


		}
	}

	focus = {
		id = GER_air_Luftwaffe_plan
		icon = GFX_focus_IRQ_fligerfuhrer_irak
		cost = 0

		relative_position_id = GER_war_plans
		x = 3
		y = 1
		search_filters = { FOCUS_FILTER_AIR_XP }
		prerequisite = { focus = GER_war_plans }
		mutually_exclusive = { focus = GER_tank_III_tank_mass_production }
		mutually_exclusive = { focus = GER_tank_tiger_dev }
		mutually_exclusive = { focus = GER_spec_gebirgsjaeger_plan }
		mutually_exclusive = { focus = GER_tank_IV_tank_production }
		completion_reward = {
			custom_effect_tooltip = GER_air_Luftwaffe_plan_tt
		}
	}

	focus = {
		id = GER_air_me262_plan
		icon = GFX_focus_generic_jet_planes
		cost = 5

		relative_position_id = GER_air_Luftwaffe_plan
		x = 0
		y = 1
		search_filters = { FOCUS_FILTER_AIR_XP }
		prerequisite = { focus = GER_air_Luftwaffe_plan }

		completion_reward = {
			custom_effect_tooltip = GER_air_me262_plan_tt
			# 航空は技術解放のみとする場合、バニラのジェット戦闘機技術IDをここで直接付与することを推奨。
			# 下記のように hidden_effect を使わず、completion_reward 直下で add_technology を記述すると検証エラーを避けられます:
			# add_technology = jet_fighter1
		}
	}


}